#include <flashinfer/attention/decode.cuh>

{% if jit %}
#include "batch_decode_generated_config.inc"
{% else %}
#include <flashinfer/attention/decode_params.cuh>
#include <flashinfer/attention/variants.cuh>
using Params = BatchDecodeParams<{{ dtype_q }}, {{ dtype_kv }}, {{ dtype_out }}, {{ idtype }}>;
{% endif %}

using namespace flashinfer;

namespace flashinfer {

template cudaError_t
BatchDecodeWithPagedKVCacheDispatched<{{ head_dim }}, {{ pos_encoding_mode }}, {{ variant_name }}, Params>(
    Params params, {{ dtype_o }}* tmp_v,
    float* tmp_s, cudaStream_t stream);

};
